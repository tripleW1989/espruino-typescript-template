"use strict";var t=require("ws");var i=require("Wifi");function e(t){return t&&typeof t==="object"&&"default"in t?t:{default:t}}var o=e(t);var r=e(i);var n=function(){function t(t){this.wsHandler=function(t){return function(i){i.on("open",(function(){console.log("Connected to server")}));i.on("message",t);i.on("close",(function(t){console.log("bye bye")}))}};this.startServer(t)}t.prototype.startServer=function(t){var i=o["default"].createServer(this.pageHandler);i.on("websocket",this.wsHandler(t));i.listen(80)};t.prototype.pageHandler=function(t,i){i.writeHead(200,{"Content-Type":"text/html"});i.end("hello")};return t}();var s=function(){function t(i){var e=i.name,o=i.password,r=i.callback;this.isConnect=false;this.connect(e,o,r);t.startAp()}t.prototype.connect=function(t,i,e){var o=this;if(t===void 0){t="ChinaNet-Eqis"}if(i===void 0){i="2xhhnwws"}r["default"].connect(t,{password:i},(function(t){if(!t){console.log("wifi connect success");o.isConnect=true;e&&e()}else{console.log("wifi connect fail",t)}}))};t.startAp=function(t){r["default"].startAP("EspruinoAP",{password:"12345678",authMode:"wpa2"},(function(i){console.log("startAP success!");if(i){console.log("err",i)}t&&t();r["default"].getAPIP((function(t,i){console.log("Connected!");console.log("err",t);console.log("ip",i)}))}))};return t}();var a=0;var c=1;var d=function(){function t(t,i,e,o){if(t===void 0){t=NodeMCU.D1}if(i===void 0){i=NodeMCU.D2}if(e===void 0){e=NodeMCU.D3}if(o===void 0){o=NodeMCU.D4}this.init(t,i,e,o)}t.prototype.init=function(t,i,e,o){this.IN1=t;this.IN2=i;this.IN3=e;this.IN4=o;pinMode(this.IN1,"output",true);pinMode(this.IN2,"output",true);pinMode(this.IN3,"output",true);pinMode(this.IN4,"output",true)};t.prototype.forward=function(){digitalWrite(this.IN1,a);digitalWrite(this.IN2,c);digitalWrite(this.IN3,a);digitalWrite(this.IN4,c)};t.prototype.back=function(){digitalWrite(this.IN1,c);digitalWrite(this.IN2,a);digitalWrite(this.IN3,c);digitalWrite(this.IN4,a)};t.prototype.stop=function(){digitalWrite(this.IN1,a);digitalWrite(this.IN2,a);digitalWrite(this.IN3,a);digitalWrite(this.IN4,a)};t.prototype.left=function(){digitalWrite(this.IN1,a);digitalWrite(this.IN2,c);digitalWrite(this.IN3,c);digitalWrite(this.IN4,a)};t.prototype.right=function(){digitalWrite(this.IN1,c);digitalWrite(this.IN2,a);digitalWrite(this.IN3,a);digitalWrite(this.IN4,c)};return t}();var l=function(){function t(){var t=this;this.auth="2dcdd31adcec";this.ssid="ChinaNet-Eqis";this.password="2xhhnwws";this.handler=function(i){console.log(t.driver);switch(i){case"right":t.driver.right();break;case"left":t.driver.left();break;case"forward":t.driver.forward();break;case"stop":t.driver.stop();break}};this.startUp=function(){t.driver=new d;s.startAp((function(){t.server=new n(t.handler)}))};console.log("server start");this.startUp()}return t}();new l;
